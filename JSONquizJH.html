<!-- Make a single page multiple choice quiz app using JavaScript and JSON.
Keywords: JSON-reading, loop, AJAX-call, mobile-optimized (bootstrap)

There should be at least 3 different multiple choice questions and they should be stored 
in a separate JSON file called questions.json.

The main page uses AJAJ (AJAX) call to fetch JSON file from the same web server 
and uses it to build a web page with a mobile friendly user interface.

After the user presses a button the JavaScript code will first verify if the user has replied all the questions,
then it will display how many questions the user got correct.

Tip: You need a web server to make this work. In other words trying to load JSON file from local file system is going to fail.
If you choose to use normal .js file instead, you will not get full points from this assignment. 

You can use either fetch API or jQuery $.getJSON(url) to fetch the JSON data from specified URL.
jQuery can also be useful to find the radio buttons the user has clicked,
but you can complete the assignment without using jQuery at all.

Use Bootstrap or similar library to make the web page responsive (mobile friendly).
Common reasons for lower grade for this assignment are the following: 
Not using external JSON file to store the questions and their answers. Not checking the answers and counting the points correctly.-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobile-Optimized Question Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
      <script>
        let questions = [];
        var options = [];

        function JSONtoArrays() {
            async function getJSONdata(url) {
              let response = await fetch(url);
              let jsonData = await response.json();               
              for (let item of jsonData) {
                questions.push(item.question);
                  options.push(item.options);
              }
              createQuizTable();
            }
          getJSONdata('quiz.json');
        }
        JSONtoArrays();

        function createQuizTable () {
            let quizrow = document.getElementById('quizrow'); //row div
            for (let i = 0; i < questions.length; i++) {
                //ensin luodaan kysymysten vaatima määrä -tr elementtejä
                  let quizSet = document.createElement('div'); //col-sm-4 tyyppi, tule rown sisään tähän kysymykset ja vastaukset
                  let question = document.createElement('h6'); //tähän kysymys
                  quizSet.className = "col-sm-4 quizset";
                  question.innerText = questions[i];
                  quizrow.appendChild(quizSet);
                  quizSet.appendChild(question);

                  for (let j = 0; j < options[i].length; j++) {
                      let answerDiv = document.createElement('div');
                      let input = document.createElement('input');
                      let label = document.createElement('label');
                      answerDiv.className = 'form-check radio';
                      input.className = 'form-check-input';
                      input.type = 'radio';
                      input.id = "option" + i + j;
                      input.name = "option" + i;
                      label.innerText = `${options[i][j].text}`;
                      label.htmlFor = "option" + i + j;
                      label.appendChild(input);
                      answerDiv.appendChild(label);
                      input.value = options[i][j].value;
                      quizSet.appendChild(answerDiv);
                  }
            }
        }

        function checkAnswers () {
          let selectedAnswers = [];
          let correctAnswers = 0;
          let result = document.getElementById('result');
          let totalAnswers = 0;

          for (let i = 0; i < questions.length; i++) {
            let selected = document.getElementsByName("option" + i);
            for (let j = 0; j < selected.length; j++) {
              if (selected[j].checked) {
                selectedAnswers.push(selected[j].value);
                totalAnswers++;

                if (selected[j].value == 1) {
                  correctAnswers++;
                }
              }
            }
          }

          if (selectedAnswers.length < 6) {
              result.innerText = `Et vastannut kaikkiin kysymyksiin. Vastaa vielä ${questions.length - selectedAnswers.length} kysymykseen.`;
              result.style.color = "red";
          } else if (correctAnswers == 6) {
              result.innerText = `Onneksi olkoon, sait kaikki oikein! Oikeita vastauksia oli ${correctAnswers}/${questions.length}.`;
              result.style.color = "black";
          } 
          else {
              result.innerText =  `Sait oikein ${correctAnswers}/${questions.length} kysymyksestä.`;
              result.style.color = "black";
          }

          event.preventDefault();
          return false;
        }

    </script>
</head>
<style>
  body {
    background-color: rgb(236, 234, 234);
  }
  button {
    float: right;
  }
  input[type="radio"] {
    margin-right: 0.5em;
    float:left;
    }
  output {
    font-size: 1.3em;
    margin: 0 auto;
  }
  .quizset {
    margin-bottom: 1em;
  }
  .text-center {
    margin: 2em 0 2em 0;
  }
  .result {
    margin-top: 3em;
  }

</style>
<body>
  <div class="jumbotron text-center">
    <h1>Tietovisa</h1>
  </div>
  <form>
    <div id="quizcontainer" class="container">
      <div class="jumbotron">
        <div id="quizrow" class="row"></div>
        <button class="btn btn-primary" type="submit" onclick="checkAnswers()">Submit</button>
      </div>
    </div> 
  </form>
  <div class="jumbotron text-center result">
    <output id="result"></output>
  </div>
</body>
</html>
